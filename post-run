#!/bin/bash

rm -rf latest-*
lastDumpName=`ls -lah dump/ | tail -n1 | rev | cut -d' ' -f1 | rev `
lastDumpTimestamp=$(cut -d '-' -f1 <<< $lastDumpName)
cp -rf dump/$lastDumpTimestamp* .

rename "$lastDumpTimestamp" 'latest' $lastDumpTimestamp-*

[ -f latest-general ] && {
    echo '
    set term png
    set output "latest-general.png"
    plot "latest-general" using 2  title "Frequency" with lines,  \
       "" using 3 title "Pulse Rate" with lines,  \
         "" using 4 title "Loudness" with lines
    ' | gnuplot
    xdg-open latest-general.png
}

[ -f latest-objective ] && {
    echo '
    set term png
    set output "latest-objective.png"
    plot "latest-objective" using 1  title "Best" with lines, \
    "" using 2 title "Average" with lines, \
    ' | gnuplot
    xdg-open latest-objective.png
}


notify-send "Execution finished"
